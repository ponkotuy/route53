# Route53

---

## Route53とは
AmazonのDNSまわりのマネージドサービス

- コンテンツサーバ
- レジストラ
- Traffic flow

の3つの機能がある

### Traffic flow
分からないので今回対象にしない

---

## そもDNSって
ホスト名からIPアドレスを特定するための仕組み

- 読み易いアドレスを振る
- IPアドレスが変更しやすく
- スケールしやすい

実際の結果は以下のデバッグツールで見れる

- drill
- dig

---

DNSサーバと呼ばれるものは2種類ある

### コンテンツ(権威)サーバ
- 担当領域ドメインのマスター変換テーブルを持つ
- 担当外は特にデータを持たない
- 一般にユーザの問い合わせは受け付けない

### キャッシュサーバ
- ユーザがDNS解決するために使う
- 全ての問い合わせを解決できる
- キャッシュに無い分はコンテンツサーバに問い合わせ
- 8.8.8.8とか8.8.4.4がソレ

---

## Route53を一言で
自分が管理するドメインのコンテンツサーバを提供するサービス

### レジストラは？
ドメインをレジストリから取得するサービス

Amazonでhogehoge.comとか買える!

---

## DNS設定
property.nomad-a.jpを例に

- ドメインはnomad-a.jp
- サブドメインはproperty

なので

- Hosted zonesのnomad-a.jpドメインで
- propertyサブドメインにレコードを設定する

```
property.nomad-a.jp.  CNAME  nomadproperty-981514728.ap-northeast-1.elb
```

CNAMEってなんだ

---

## DNSレコード
### A
ホスト名にIPアドレスを定義する

IPアドレスは複数定義できる

### CNAME
ホスト名に別のホスト名を定義する

**同ホストにそれ以外のレコードを設定できない**

---

### MX
メールの転送設定

優先度がある

### TXT
単なるテキスト

メールのドメイン認証に使ったり

---

## Alias
Route53独自機能

ELB(CNAMEが必要)への接続を

Aレコードでできる機能

同時にMX(メール)が使える

---

## 余談
### Herokuがつらいところ
CNAMEの設定を要求する

### value-domainがつらいところ
AliasでELBに繋げない

### NLBがすごいところ
AレコードでELBがつかえて早い
